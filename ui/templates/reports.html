<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reports - GoBI</title>
    <link rel="stylesheet" href="/ui/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/htmx.org@1.9.5"></script>
</head>

<body hx-boost="true">
    <div class="dashboard-container">
        {{template "nav" .}}

        <main class="main-content">
            {{template "header" .}}

            <div id="reports-list-container">
                {{define "reports_list"}}
                <div class="reports-grid animate-fade-in">
                    {{range .Reports}}
                    <a href="/report?id={{.ID}}" class="report-pane" id="{{.ID}}">
                        <div class="report-icon">
                            <i class="fas fa-chart-pie"></i>
                        </div>
                        <div>
                            <h3>{{.Title}}</h3>
                            <p>{{.Description}}</p>
                        </div>
                        <div class="report-meta">
                            <span><i class="fas fa-table mr-1"></i> {{.TableName}}</span>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </a>
                    {{else}}
                    <div class="empty-reports">
                        <i class="fas fa-file-circle-exclamation"></i>
                        <div>
                            <h2>No Reports Found</h2>
                            <p>There are no aggregate reports configured in the repository.</p>
                        </div>
                        <a href="/" class="btn btn-primary">Go to Dashboard</a>
                    </div>
                    {{end}}
                </div>

                {{if or .HasPrev .HasNext}}
                <div class="reports-pagination animate-fade-in">
                    <button hx-get="/reports?offset={{.PrevOffset}}&limit={{.Limit}}"
                        hx-target="#reports-list-container" hx-push-url="true"
                        class="icon-btn {{if not .HasPrev}}disabled{{end}}" {{if not .HasPrev}}disabled{{end}}>
                        <i class="fas fa-chevron-left"></i>
                    </button>

                    <div class="page-info">
                        Page <strong>{{.CurrentPage}}</strong> of {{.TotalPages}}
                    </div>

                    <button hx-get="/reports?offset={{.NextOffset}}&limit={{.Limit}}"
                        hx-target="#reports-list-container" hx-push-url="true"
                        class="icon-btn {{if not .HasNext}}disabled{{end}}" {{if not .HasNext}}disabled{{end}}>
                        <i class="fas fa-chevron-right"></i>
                    </button>

                    <div class="btn-group ml-4">
                        <button class="btn btn-fixed-width" hx-get="/reports?offset=0&limit={{.NextLimit}}"
                            hx-target="#reports-list-container" hx-push-url="true" title="Change items per page">
                            {{.Limit}} / page
                        </button>
                    </div>
                </div>
                {{end}}
                {{end}}
                {{template "reports_list" .}}
            </div>
        </main>
        {{template "footer" .}}
    </div>
</body>

</html>